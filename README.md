# 📱 TradeSim - 株価分析学習アプリ

**🆕 v2.1 メトリクス表示改善版 | 🏆 品質保証済み**
初心者から上級者まで、株価分析とポートフォリオ管理を直感的に学べる教育専用Webアプリです。

## 🌐 ライブデモ

**[📱 今すぐ使ってみる！](https://tradesim-9djzkadr39vp8jt2dxcgud.streamlit.app/)**

## 🆕 主な機能

### 🎯 動的重み付け分析
- **🔒 固定重み付け**: 安定した従来の分析手法（初心者推奨）
- **🎯 適応重み付け**: 相場パターンに応じて重み付けを自動調整（中級者以上）
- **🔧 手動重み付け**: 完全カスタマイズ可能（上級者向け）

### 📊 直感的なメトリクス表示（v2.1で改善！）
- **🟢 緑色表示**: プラスの成果（利益、上昇）
- **🔴 赤色表示**: マイナスの成果（損失、下降）
- **💰 リアルタイム指標**: 前日比、期間全体の変化を色分け表示
- **📈 バックテスト結果**: 投資シミュレーションの損益を直感的に表示

### 📊 相場パターン検出
6つのパターンを自動検出し、最適な分析戦略を提案：

| パターン | 説明 | 戦略 | リスク |
|----------|------|------|--------|
| **上昇トレンド** | 持続的な価格上昇 | 移動平均・MACD重視 | 🟡 中 |
| **下降トレンド** | 持続的な価格下降 | 移動平均・MACD重視の反転待ち | 🔴 高 |
| **レンジ相場** | 一定範囲内での変動 | RSI・ボリンジャーバンド重視 | 🟢 低 |
| **転換期** | トレンド変化の可能性 | MACD最重視の早期検出 | 🔴 高 |
| **加速相場** | 急激な価格変動 | 出来高重視の持続性判断 | 🔴 高 |
| **調整局面** | 大きな動きの後の調整 | ボリンジャーバンド・RSI重視 | 🟢 低 |

### 🔍 その他の機能
- **📊 テクニカル分析**: 移動平均、RSI、ボリンジャーバンド、MACD
- **🔍 スマート銘柄検索**: 日本語・英語での会社名検索
- **💰 投資シミュレーション**: リアルなバックテスト機能
- **💼 ポートフォリオ管理**: ウォッチリスト機能
- **📱 レスポンシブUI**: 全デバイス対応

## 🚀 クイックスタート

### オンライン利用（推奨）
**[📱 ライブデモ](https://tradesim-9djzkadr39vp8jt2dxcgud.streamlit.app/)**をクリックするだけ！

### ローカル実行
```bash
git clone https://github.com/your-username/TradeSim.git
cd TradeSim
pip install -r requirements.txt
streamlit run app.py
```

## 📊 使い方

### 基本的な流れ
1. **銘柄選択**: 会社名検索（例：「トヨタ」「Apple」）または銘柄コード入力（例：「AAPL」「7203.T」）
2. **分析手法選択**: 固定・適応・手動の重み付けモードから選択
3. **分析実行**: 「🚀 分析開始」ボタンまたはEnterキー
4. **結果確認**: パターン検出結果、チャート、バックテスト結果を確認
5. **ポートフォリオ管理**: 気になる銘柄をウォッチリストに追加

### 📈 メトリクス表示の見方（v2.1で改善！）
**直感的な色分け表示:**
- 🟢 **緑色**: プラスの成果（利益、上昇、良好な指標）
- 🔴 **赤色**: マイナスの成果（損失、下降、注意が必要な指標）

**表示例:**
```
💰 現在の株価: ¥1,608.00
📈 前日比: -0.16% 🔴¥-2.50    ← マイナスは赤色
📊 期間全体: +15.93% 🟢¥+221.00 ← プラスは緑色

💵 仮想最終資産: ¥1,150,000 🟢¥+150,000 ← 利益は緑色
📈 総リターン: +15.0% 🟢+15.0% ← プラスリターンは緑色
📉 最大下落幅: -8.5% 🟢-8.5% ← 小さいドローダウンは緑色
```

### 適応重み付けの例
**上昇トレンド検出時:**
```
🎯 パターン: 上昇トレンド (信頼度: 85%)
⚖️ 重み付け: 移動平均35% | MACD30% | その他35%
💡 戦略: トレンドフォロー戦略を推奨
```

## 🧪 品質保証

### テスト結果
- **総テスト数**: 58個
- **成功率**: 100% ✅
- **実行時間**: 6.76秒
- **UI改善**: メトリクス表示の直感性向上 ✅

```bash
# テスト実行
pytest tests/
# ============== 58 passed in 6.76s ==============
```

### テスト内容
| カテゴリ | テスト数 | 内容 |
|----------|----------|------|
| **統合テスト** | 14個 | 全体フロー、エラー処理、UI動作 |
| **シグナル生成** | 24個 | 動的重み付け、個別指標 |
| **テクニカル分析** | 20個 | 指標計算、パフォーマンス |

## 🔧 技術仕様

### 主要技術スタック
- **Streamlit**: Webアプリフレームワーク
- **yfinance**: 株価データ取得
- **Plotly**: インタラクティブチャート
- **TA-Lib**: テクニカル分析
- **Pandas/NumPy**: データ処理

### UI/UX技術
- **レスポンシブデザイン**: 全デバイス対応
- **直感的メトリクス**: Streamlit st.metric による色分け表示
- **アクセシビリティ**: 色覚に配慮したデザイン
- **リアルタイム更新**: 動的データ表示

### プロジェクト構造
```
TradeSim/
├── app.py                    # メインアプリケーション
├── tests/                    # テストスイート (58個)
├── config/                   # 設定管理
├── core/                     # アプリケーションコア
├── data/                     # データ取得・管理
├── analysis/                 # 分析エンジン
│   └── pattern_detector.py  # 🆕 パターン検出
├── ui/                       # ユーザーインターフェース
└── portfolio/                # ポートフォリオ管理
```

### 動的重み付けアルゴリズム
```python
# パターンに応じた重み付け例
WEIGHT_PROFILES = {
    'uptrend': {
        'ma_trend': 0.35,     # 移動平均35%
        'macd': 0.30,         # MACD30%
        'bollinger': 0.15,    # ボリンジャーバンド15%
        'rsi': 0.15,          # RSI15%
        'volume': 0.05        # 出来高5%
    }
}
```

### メトリクス色分けシステム（v2.1新機能）
```python
# Streamlit st.metric の色分け実装例
st.metric(
    label="前日比",
    value=f"{change_pct:+.2f}%",
    delta=f"¥{change_val:+.2f}",
    delta_color="normal"  # 正=緑、負=赤
)
```

## 📈 サポート銘柄

### 🇯🇵 日本株
トヨタ(7203.T), ソニー(6758.T), 任天堂(7974.T), ソフトバンク(9984.T), キーエンス(6861.T)

### 🇺🇸 米国株
Apple(AAPL), Microsoft(MSFT), Google(GOOGL), Amazon(AMZN), Tesla(TSLA), NVIDIA(NVDA), Meta(META)

## 📚 教育コンテンツ

### 学習目標
- **株式投資の基本概念**の理解
- **テクニカル分析**の実践的習得
- **リスク管理**の重要性認識
- **パターン分析**による高度な判断力育成
- **視覚的情報理解**による直感的判断力向上

### 実践的アドバイス
- 💰 余裕資金での投資の重要性
- 🎯 分散投資によるリスク軽減
- 😌 感情的にならない投資判断
- 📈 長期的視点の保持
- 🎨 色分け表示による直感的理解

## 🆕 v2.1 更新内容

### UI/UX改善
- ✅ **メトリクス色分け修正**: 損益・変動率の色表示を直感的に改善
- ✅ **前日比表示**: マイナス変動は赤色、プラス変動は緑色で正しく表示
- ✅ **バックテスト結果**: 投資シミュレーションの損益が適切な色で表示
- ✅ **ユーザビリティ向上**: 一目で成果を判断できるビジュアル改善

### 技術的改善
- ✅ **Streamlit st.metric**: delta_color パラメータの適切な実装
- ✅ **コードメンテナンス**: メトリクス表示ロジックの標準化
- ✅ **アクセシビリティ**: 色覚に配慮した情報表示の改善

### メトリクス色分けルール
| `delta_color` | 正の値 | 負の値 | 使用場面 |
|---------------|--------|--------|----------|
| `"normal"` | 🟢 緑 | 🔴 赤 | リターン、利益、価格変動 |
| `"inverse"` | 🔴 赤 | 🟢 緑 | ドローダウン、リスク指標 |
| `"off"` | 無色 | 無色 | 色分け不要な場合 |

## 🆕 v2.0 更新内容

### 新機能
- ✅ 6つの相場パターン自動検出
- ✅ 動的重み付け分析システム
- ✅ リスクレベル自動評価
- ✅ 戦略ヒント機能

### 品質向上
- ✅ 58個の包括的テストスイート実装
- ✅ 100%テスト成功率達成
- ✅ エラーハンドリング強化
- ✅ パフォーマンス最適化

## 📄 ライセンス

MIT License - 個人・教育・商用利用自由

## ⚠️ 免責事項

本アプリケーションは**教育・学習目的専用**です。投資助言は行いません。実際の投資判断は自己責任で行い、必要に応じて専門家にご相談ください。

---

**🎯 v2.1でメトリクス表示が更に使いやすくなりました！損益や変動率が直感的な色分けで一目で分かります。**  
**🚀 v2.0で追加された動的重み付け機能により、より精度の高い株価分析学習が可能です！**
