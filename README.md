# TradeSim - 初心者向け株価分析アプリ

初心者でも理解できる株価分析とバックテストシミュレーションを提供するStreamlitアプリケーション。テクニカル分析、投資シミュレーション、ポートフォリオ管理機能を搭載し、教育的な投資学習を支援します。

## 🌐 ライブデモ

**📱 [TradeSim - 今すぐ使ってみる！](https://tradesim-9djzkadr39vp8jt2dxcgud.streamlit.app/)**

> 🔰 ブラウザで即座に利用可能！インストール不要でお試しいただけます。

## 主要機能

### 🔍 インテリジェント銘柄検索

- **多言語対応検索**: 日本語・英語での会社名検索（「トヨタ」「Apple」「任天堂」等）
- **人気銘柄選択**: よく投資される主要銘柄からの簡単選択
- **Alpha Vantage API統合**: より広範囲の銘柄検索（API Key使用時）
- **自動銘柄コード変換**: 会社名から銘柄コードへの自動変換

### 📊 高度なテクニカル分析

- **移動平均線**: 短期・長期移動平均による トレンド分析
- **RSI指標**: 買われすぎ・売られすぎの判定（0-100スケール）
- **ボリンジャーバンド**: 価格の正常範囲と異常値の検出
- **MACD**: モメンタム分析と売買シグナル生成
- **出来高分析**: 取引量による市場参加度の評価

### 🎯 AI駆動型投資判断

- **スコアベースシグナル**: 複数指標を統合した買い・売り・中立判定
- **判断根拠表示**: 初心者にも分かりやすい判断理由の説明
- **リアルタイム分析**: 最新データに基づく投資推奨

### 💰 リアリスティック投資シミュレーション

- **バックテスト機能**: 過去データを使った投資戦略の検証
- **リスク管理**: 損切り・利益確定ルールの実装
- **手数料考慮**: 実際の取引コストを含む現実的なシミュレーション
- **パフォーマンス分析**: シャープレシオ、最大ドローダウン等の指標

### 💼 ポートフォリオ管理

- **お気に入り銘柄管理**: 注目銘柄のリスト化と追跡
- **投資成績追跡**: 投資金額、現在価値、損益の自動計算
- **全体パフォーマンス**: ポートフォリオ全体の成績サマリー

---

## 核心機能

| 機能 | 説明 | 主要メリット |
|------|------|-------------|
| **銘柄検索・分析** | 日米主要銘柄の自動検索と分析 | 簡単な会社名入力で詳細分析が可能 |
| **テクニカル指標** | 5種類の主要指標による多角的分析 | 初心者にも分かりやすい解説付き |
| **投資シミュレーション** | 過去データでの投資戦略検証 | リスクなしで投資手法を学習 |
| **教育的インターフェース** | 分かりやすい説明 | 投資の基礎知識を自然に習得 |
| **リスク管理教育** | 損切り・利益確定の重要性を実践的に学習 | 健全な投資習慣の形成 |

---

## クイックスタート

### 🌐 オンラインで試す（推奨）

**[📱 ライブデモはこちら](https://tradesim-9djzkadr39vp8jt2dxcgud.streamlit.app/)**

ブラウザですぐに利用開始！インストール不要です。

### 💻 ローカル環境で実行

```bash
# リポジトリをクローン
git clone https://github.com/your-username/TradeSim.git
cd TradeSim

# 依存関係をインストール
pip install -r requirements.txt

# アプリケーションを実行
streamlit run app.py
```

### 基本的な使用方法

1. **銘柄選択**: 会社名検索、人気銘柄選択、またはコード直接入力
2. **期間設定**: 分析期間を1ヶ月〜2年から選択
3. **分析実行**: 「🚀 分析開始」ボタンをクリック
4. **結果確認**: AI判断、チャート、シミュレーション結果を確認
5. **ポートフォリオ管理**: 気になる銘柄をお気に入りリストに保存

---

## 技術仕様

### コア依存関係

| ライブラリ | 用途 | 主要機能 |
|-----------|------|----------|
| **Streamlit** | Webアプリケーションフレームワーク | UI構築、インタラクション |
| **yfinance** | 株価データ取得 | リアルタイム・履歴データ |
| **Plotly** | インタラクティブチャート | 動的グラフ表示 |
| **TA-Lib (ta)** | テクニカル分析 | 各種指標計算 |
| **Pandas/NumPy** | データ処理 | データ操作・統計計算 |
| **SciPy** | 統計分析 | 高度な数値計算 |

### アーキテクチャ概要

```
app.py                    # メインアプリケーション
├── 銘柄検索システム       # LocalStockSearch クラス
├── データ取得・処理       # yfinance + 指標計算
├── シグナル生成          # generate_signals_advanced()
├── バックテスト実行       # backtest_realistic()
├── UI コンポーネント      # Streamlit ベース
└── ポートフォリオ管理     # セッション状態管理
```

---

## 高度な機能

### テクニカル指標システム

#### 移動平均線
```python
short_ma = 20  # 短期移動平均（日数）
long_ma = 50   # 長期移動平均（日数）
# ゴールデンクロス・デッドクロス検出
trend_signal = short_ma > long_ma  # 上昇トレンド判定
```

#### RSI（相対力指数）
```python
rsi_period = 14  # 計算期間
# 判定基準
oversold = rsi < 35    # 売られすぎ（買いシグナル）
overbought = rsi > 65  # 買われすぎ（売りシグナル）
```

#### ボリンジャーバンド
```python
bb_period = 20  # 期間
bb_std = 2      # 標準偏差
# 価格位置判定
below_lower = price < lower_band  # 安値圏
above_upper = price > upper_band  # 高値圏
```

### シグナル生成アルゴリズム

#### スコアベース判定システム

| 指標 | 買いシグナル条件 | 売りシグナル条件 | 重み |
|------|------------------|------------------|------|
| **移動平均** | 短期 > 長期 | 短期 < 長期 | 1.0 |
| **RSI** | < 35 | > 65 | 1.0 |
| **ボリンジャーバンド** | < 下限 | > 上限 | 1.5 |
| **MACD** | ゴールデンクロス | デッドクロス | 1.5 |
| **出来高** | > 平均 | > 平均 | 0.5 |

```python
# 判定閾値
buy_threshold = 2.5   # 買いシグナル発生
sell_threshold = 2.5  # 売りシグナル発生
# スコア合計がしきい値を超えた場合にシグナル発生
```

### リアリスティックバックテスト

#### リスク管理パラメータ

| パラメータ | デフォルト値 | 説明 |
|-----------|-------------|------|
| **初期資金** | 100万円 | シミュレーション開始資金 |
| **リスク許容率** | 2.0% | 1回の取引での最大リスク |
| **損切り率** | 5.0% | 自動損切りライン |
| **利益確定率** | 15.0% | 自動利益確定ライン |
| **取引手数料** | 0.1% | 現実的な手数料設定 |

#### ポジションサイジング

```python
# リスクベースポジションサイジング
risk_per_share = entry_price - stop_loss_price
capital_at_risk = total_capital * (risk_pct / 100.0)
position_size = capital_at_risk / risk_per_share

# 手数料考慮
total_cost = position_size * entry_price * (1 + cost_rate)
```

---

## 銘柄検索システム

### サポート銘柄

#### 日本株
- **自動車**: トヨタ(7203.T), ホンダ(7267.T), 日産(7201.T)
- **テクノロジー**: ソニー(6758.T), 任天堂(7974.T), キーエンス(6861.T)
- **金融**: 三菱UFJ(8306.T), ソフトバンク(9984.T)
- **小売**: ユニクロ(9983.T), セブン(3382.T), イオン(8267.T)

#### 米国株
- **GAFAM**: Apple(AAPL), Microsoft(MSFT), Google(GOOGL), Amazon(AMZN), Meta(META)
- **テクノロジー**: NVIDIA(NVDA), Tesla(TSLA), Netflix(NFLX)
- **伝統的企業**: Disney(DIS), Nike(NKE), McDonald's(MCD), Coca-Cola(KO)

### 検索機能

```python
class LocalStockSearch:
    def search(self, keyword):
        # 完全一致 → 部分一致の順で検索
        # 日本語・英語キーワード対応
        # 最大5件の結果を返却
```

#### Alpha Vantage API統合（オプション）

```python
# 無料API利用で世界中の銘柄検索が可能
api_endpoint = "https://www.alphavantage.co/query"
function = "SYMBOL_SEARCH"
# 1日500回まで無料利用可能
```

---

## UI/UX設計

### スマートフォン最適化

- **レスポンシブデザイン**: 768px以下でモバイル最適化
- **大きなボタン**: タッチ操作に配慮した1.2rem以上のボタン
- **読みやすいフォント**: 1.05rem以上の本文、高コントラスト
- **視認性重視**: 白背景に黒文字、境界線で明確な区分

### 教育的インターフェース

#### 段階的な情報開示
```markdown
基本情報 → 詳細設定（折りたたみ） → 上級者向け設定
初心者ガイド → 解説ボックス → Tips
```

#### 分かりやすい説明

| 要素 | 表現方法 | 目的 |
|------|----------|------|
| **解説ボックス** | 青枠 + 太字見出し | 基本概念の説明 |
| **Tipボックス** | オレンジ枠 + 電球アイコン | 実用的なアドバイス |
| **指標説明** | 絵文字 + 平易な日本語 | 専門用語の理解促進 |
| **判断理由** | チェックマーク + 根拠 | 透明性のある判定 |

### ダークモード対応

```css
@media (prefers-color-scheme: dark) {
    .explanation-box {
        background: #1a1a1a !important;
        border: 3px solid #64b5f6 !important;
        color: #ffffff !important;
    }
}
```

---

## データ管理

### セッション状態管理

```python
# ポートフォリオデータの永続化
if 'portfolio' not in st.session_state:
    st.session_state.portfolio = {}

# 銘柄情報の管理
portfolio_structure = {
    'symbol': {
        'shares': int,
        'avg_price': float,
        'longName': str
    }
}
```

### キャッシュ戦略

```python
@st.cache_data
def fetch_stock_data(symbol, start, end):
    # 株価データの取得とキャッシュ
    # 同一パラメータでの重複取得を防止
```

### エラーハンドリング

| エラータイプ | 対処法 | ユーザー向けメッセージ |
|-------------|--------|----------------------|
| **ネットワークエラー** | 再試行ロジック | "データ取得中...少しお待ちください" |
| **銘柄コードエラー** | バリデーション | "銘柄コードが正しくありません" |
| **データ不足** | 代替データ表示 | "一部データが取得できませんでした" |
| **API制限** | 適切な待機時間 | "アクセスが集中しています" |

---

## パフォーマンス指標

### バックテスト評価指標

#### 基本指標
```python
# 総リターン
total_return_pct = (final_value / initial_capital - 1) * 100

# シャープレシオ
sharpe_ratio = (mean_return / std_return) * sqrt(252)

# 最大ドローダウン
max_drawdown = min(portfolio_value / cummax(portfolio_value) - 1) * 100
```

#### 成績判定基準

| リターン範囲 | 判定 | 表示 |
|-------------|------|------|
| **> 10%** | 優秀 | 🎉 素晴らしい成績！ |
| **0% ~ 10%** | 良好 | 👍 まずまずの成績 |
| **< 0%** | 要改善 | 📚 改善が必要 |

### リスク管理指標

```python
# ボラティリティ（年率）
annual_volatility = std(daily_returns) * sqrt(252) * 100

# 勝率
win_rate = (winning_trades / total_trades) * 100

# 平均保有期間
avg_holding_period = total_holding_days / total_trades
```

---

## 設定オプション

### テクニカル指標設定

```python
# カスタマイズ可能パラメータ
technical_settings = {
    'short_ma': {'min': 5, 'max': 50, 'default': 20},
    'long_ma': {'min': 20, 'max': 200, 'default': 50},
    'rsi_period': {'min': 5, 'max': 30, 'default': 14},
    'bb_period': {'min': 10, 'max': 30, 'default': 20}
}
```

### 投資シミュレーション設定

```python
# リスク管理設定
risk_settings = {
    'initial_capital': {'min': 100000, 'max': 10000000, 'default': 1000000},
    'risk_per_trade': {'min': 0.5, 'max': 5.0, 'default': 2.0},
    'stop_loss_pct': {'min': 1.0, 'max': 20.0, 'default': 5.0},
    'take_profit_pct': {'min': 2.0, 'max': 50.0, 'default': 15.0},
    'trade_cost_rate': {'min': 0.0, 'max': 1.0, 'default': 0.1}
}
```

---

## 教育コンテンツ

### 投資基礎教育

#### 基本概念の説明
- **株式とは**: "会社の一部を買うこと"
- **リスクとリターン**: "大きく儲かるかもしれないけど、損するかもしれない"
- **分散投資**: "卵を一つのカゴに盛らない"
- **長期投資**: "短期間で大儲けしようと思わない"

#### 実践的なアドバイス

| 項目 | 初心者向けアドバイス |
|------|-------------------|
| **開始資金** | 余裕資金から少額スタート |
| **銘柄選択** | 知っている会社から始める |
| **売買タイミング** | 事前にルールを決めておく |
| **感情管理** | 慌てて売買しない |
| **学習継続** | 分からないことは調べる |

### リスク教育

#### 警告表示
```markdown
⚠️ このアプリは勉強用です
⚠️ 実際にお金を使う時は、大人と相談しましょう
⚠️ コンピューターの判断が100%正しいわけではありません
⚠️ 株価は上がったり下がったりするのが普通です
```

#### 健全な投資習慣の促進
- 損切りルールの重要性
- ポートフォリオ分散の効果
- 長期投資の考え方
- 情報収集の大切さ

---

## 展開オプション

### ローカル開発

```bash
# 開発環境構築
git clone https://github.com/your-username/TradeSim.git
cd TradeSim
pip install -r requirements.txt

# 開発モード実行
streamlit run app.py --server.runOnSave=true
```

### プロダクション展開

#### Streamlit Community Cloud
```bash
# 1. GitHubにプッシュ
git push origin main

# 2. share.streamlit.io でリポジトリ接続
# 3. 環境変数設定（Alpha Vantage API Key等）
```

#### 自前ホスティング
```bash
# 1. 依存関係インストール
pip install -r requirements.txt

# 2. リバースプロキシ設定 (nginx/apache)
# 3. プロセス管理 (systemd/supervisor)

# 4. SSL証明書設定
# 5. ドメイン設定
```

### API利用とコスト

#### Yahoo Finance (yfinance)
- **料金**: 完全無料
- **制限**: 合理的な使用範囲内で制限なし
- **データ**: 日米主要市場の株価・企業情報

#### Alpha Vantage API（オプション）
- **無料プラン**: 1日500回、1分5回まで
- **有料プラン**: $49.99/月〜（制限緩和）
- **データ**: 世界中の市場データ

---

## トラブルシューティング

### よくある問題

| 問題 | 症状 | 解決方法 |
|------|------|----------|
| **データ取得失敗** | "データ取得エラー"表示 | インターネット接続確認、銘柄コード確認 |
| **チャート表示エラー** | グラフが空白 | ブラウザ更新、期間設定変更 |
| **検索結果なし** | "検索結果が見つかりません" | キーワード変更、API Key設定 |
| **ポートフォリオエラー** | 保存できない | ブラウザキャッシュクリア |

### デバッグモード

```bash
# 詳細ログ出力
streamlit run app.py --logger.level=debug

# データ取得テスト
python -c "import yfinance as yf; print(yf.Ticker('AAPL').info)"

# API接続テスト
python -c "import requests; print(requests.get('https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=AAPL&apikey=demo').json())"
```

### パフォーマンス最適化

```python
# キャッシュクリア
st.cache_data.clear()

# メモリ使用量確認
import psutil
print(f"Memory: {psutil.virtual_memory().percent}%")

# セッション状態リセット
for key in st.session_state.keys():
    del st.session_state[key]
```

---

## 開発ロードマップ

### Version 1.0 (現在)
- ✅ 基本的な株価分析機能
- ✅ テクニカル指標5種類
- ✅ バックテストシミュレーション
- ✅ ポートフォリオ管理
- ✅ モバイル最適化
- ✅ 教育的コンテンツ

---

## コントリビューション

### 開発セットアップ

```bash
# フォーク & クローン
git clone https://github.com/your-username/TradeSim.git
cd TradeSim

# 開発ブランチ作成
git checkout -b feature/new-feature

# 依存関係インストール
pip install -r requirements.txt
```

### コード規約

- **Pythonスタイル**: PEP 8 準拠
- **ドキュメント**: 全関数にdocstring
- **エラーハンドリング**: 包括的な例外管理
- **テスト**: 手動テスト手順の文書化

### 新機能追加ガイド

| 機能タイプ | 必要な変更 |
|-----------|-----------|
| **新しいテクニカル指標** | calculate_indicators()関数拡張 |
| **新しい銘柄市場** | LocalStockSearch辞書追加 |
| **新しいUI要素** | Streamlitコンポーネント追加 |
| **新しい分析機能** | 新規関数作成 + UI統合 |

---

## ライセンス & 謝辞

**ライセンス**: MIT License - 個人、教育、商用利用自由

**データソース**:
- Yahoo Finance: 無料株価データAPI
- Alpha Vantage: 世界市場データ（オプション）
- 企業情報: 各企業の公開情報

**使用技術**:
- **Streamlit**: 高速Webアプリ開発フレームワーク
- **Plotly**: インタラクティブ可視化
- **TA-Lib**: 金融テクニカル分析ライブラリ
- **yfinance**: Yahoo Finance データ取得

**謝辞**:
- オープンソースコミュニティ
- 金融教育の推進に貢献する全ての方々
- ベータテスターの皆様
- Streamlitチームの素晴らしいフレームワーク

**免責事項**:
- このアプリケーションは教育目的で作成されています
- 投資判断は自己責任でお願いします
- 過去の成績は将来の結果を保証するものではありません
- 実際の投資前には専門家にご相談ください
