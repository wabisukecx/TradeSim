# 📱 TradeSim - 株価分析学習アプリ（動的重み付け対応）

**🆕 動的重み付け分析機能搭載**

教育・学習目的の株価分析とバックテストシミュレーションアプリケーション。初心者から上級者まで、テクニカル分析とポートフォリオ管理を直感的に学べるWebアプリです。

## 🌐 ライブデモ

**[📱 今すぐ使ってみる！](https://tradesim-9djzkadr39vp8jt2dxcgud.streamlit.app/)**

> 🔰 ブラウザで即座に利用可能！インストール不要でお試しいただけます。

## 🆕 v2.0の主な新機能

### 🎯 相場パターン検出
- **自動パターン認識**: 上昇トレンド、下降トレンド、レンジ相場、転換期、加速相場、調整局面を自動検出
- **信頼度評価**: 検出結果の信頼度を%で表示
- **戦略提案**: 検出されたパターンに応じた最適な投資戦略をヒントとして提供

### ⚖️ 動的重み付け分析システム
- **🔒 固定重み付け**: 従来の安定した分析手法（初心者推奨）
- **🎯 適応重み付け**: 相場状況に応じて重み付けを自動調整（中級者以上）
- **🔧 手動重み付け**: 完全カスタマイズ可能な重み付け設定（上級者向け）

### 📊 高精度分析機能
- **リアルタイム最適化**: 相場状況に応じてテクニカル指標の重要度を動的調整
- **パターン別戦略**: 検出されたパターンに最適化された分析重み付け
- **信頼度フィルタリング**: 低信頼度パターンの場合は自動的に固定重み付けにフォールバック

## ✨ 全機能一覧

### 🔍 分析機能
- **📊 多角的テクニカル分析**: 移動平均線、RSI、ボリンジャーバンド、MACDによる総合判定
- **🎯 動的重み付け**: 相場パターンに応じた最適な重み付け自動調整
- **🤖 パターン検出**: 6種類の相場パターンを自動識別
- **📈 リスクレベル評価**: 検出パターンに応じたリスク度合いの表示

### 🔍 検索・選択機能
- **🔍 スマート銘柄検索**: 日本語・英語での会社名検索（「トヨタ」「Apple」等）
- **⌨️ 直接コード入力**: 銘柄コードによる高速検索
- **✅ リアルタイム検証**: 入力と同時に銘柄の妥当性を確認

### 💰 シミュレーション機能
- **💰 リアリスティック投資シミュレーション**: 過去データを使った戦略検証
- **📊 3段階リスク設定**: 初心者向け・バランス型・積極型の自動設定
- **🎛️ 詳細カスタマイズ**: 上級者向けの細かいパラメータ調整

### 💼 ポートフォリオ管理
- **📝 ウォッチリスト**: 注目銘柄の追跡と投資成績分析
- **💱 多通貨対応**: 円・ドル・ユーロ・ポンドなどの通貨別表示
- **📊 パフォーマンス追跡**: 個別銘柄とポートフォリオ全体の成績管理

### 🎓 教育機能
- **🎓 教育的インターフェース**: 専門用語を平易に解説、段階的学習支援
- **📚 実践的アドバイス**: 投資の基本原則から応用戦略まで
- **⚠️ リスク教育**: 投資リスクの理解と管理方法の学習

### 📱 UI/UX
- **📱 モバイル対応**: レスポンシブデザインでスマートフォン最適化
- **🎨 直感的デザイン**: 色とアイコンによる視覚的フィードバック
- **♿ アクセシビリティ**: 高コントラスト、キーボード操作対応

## 🚀 クイックスタート

### 🌐 オンラインで試す（推奨）

**[📱 ライブデモはこちら](https://tradesim-9djzkadr39vp8jt2dxcgud.streamlit.app/)**

### 💻 ローカル実行

```bash
# 1. リポジトリをクローン
git clone https://github.com/your-username/TradeSim.git
cd TradeSim

# 2. 依存関係をインストール
pip install -r requirements.txt

# 3. アプリケーションを起動
streamlit run app.py
```

## 🎯 動的重み付け機能の使い方

### 🔄 モード選択
1. **設定エリア** → **🔧 詳細設定** → **🎯 分析手法の選択**
2. 3つのモードから選択：
   - **🔒 固定重み付け**: 安定した従来の分析
   - **🎯 適応重み付け**: 相場パターン検出による自動調整
   - **🔧 手動重み付け**: 完全カスタマイズ

### 🤖 適応重み付けの仕組み
1. **パターン検出**: 現在の相場状況を6つのパターンに分類
2. **重み調整**: 検出されたパターンに最適な重み付けを自動適用
3. **信頼度評価**: 検出精度に応じて固定重み付けへのフォールバック

### 📊 検出可能なパターン
| パターン | 説明 | 最適戦略 | リスクレベル |
|----------|------|----------|------------|
| **上昇トレンド** | 持続的な価格上昇 | 移動平均・MACD重視のトレンドフォロー | 🟡 中リスク |
| **下降トレンド** | 持続的な価格下降 | 移動平均・MACD重視の反転待ち | 🔴 高リスク |
| **レンジ相場** | 一定範囲内での価格変動 | RSI・ボリンジャーバンド重視の反転狙い | 🟢 低リスク |
| **転換期** | トレンド変化の可能性 | MACD最重視の早期転換検出 | 🔴 高リスク |
| **加速相場** | 急激な価格変動拡大 | 出来高重視の加速持続性判断 | 🔴 高リスク |
| **調整局面** | 大きな動きの後の調整 | ボリンジャーバンド・RSI重視の準備 | 🟢 低リスク |

## 📊 使用方法

### 基本的な流れ

1. **銘柄選択**
   - 会社名検索（例：「トヨタ」「Apple」）
   - 銘柄コード直接入力（例：「AAPL」「7203.T」）

2. **分析手法選択**
   - 🔒 **固定重み付け**: 初心者向け安定分析
   - 🎯 **適応重み付け**: 相場パターン検出
   - 🔧 **手動重み付け**: 完全カスタマイズ

3. **分析実行**
   - 「🚀 分析開始」ボタンクリック
   - または銘柄コード入力後にEnterキー

4. **結果確認**
   - 🤖 **相場パターン検出結果**（適応モード時）
   - 📊 **テクニカル分析結果**
   - 📈 **インタラクティブチャート**
   - 💰 **バックテスト結果**とパフォーマンス指標

5. **ポートフォリオ管理**
   - 気になる銘柄をウォッチリストに追加
   - 投資成績の追跡と分析

### 🎯 適応重み付けの活用例

**上昇トレンド検出時:**
```
🎯 検出パターン: 上昇トレンド
📊 信頼度: 85%
⚖️ 重み付け: 移動平均35%、MACD30%、ボリンジャーバンド15%、RSI15%、出来高5%
💡 戦略ヒント: 移動平均とMACDを重視し、トレンドフォローを基本戦略とする
```

**レンジ相場検出時:**
```
🎯 検出パターン: レンジ相場
📊 信頼度: 72%
⚖️ 重み付け: RSI35%、ボリンジャーバンド35%、移動平均15%、MACD10%、出来高5%
💡 戦略ヒント: RSIとボリンジャーバンドを重視し、レンジ内反転を狙う
```

### サポート銘柄

#### 🇯🇵 日本株
- **自動車**: トヨタ(7203.T), ホンダ(7267.T), 日産(7201.T)
- **テクノロジー**: ソニー(6758.T), 任天堂(7974.T), キーエンス(6861.T)
- **その他**: ソフトバンク(9984.T), 楽天(4755.T), ユニクロ(9983.T)

#### 🇺🇸 米国株
- **GAFAM**: Apple(AAPL), Microsoft(MSFT), Google(GOOGL), Amazon(AMZN), Meta(META)
- **テクノロジー**: NVIDIA(NVDA), Tesla(TSLA), Netflix(NFLX)
- **その他**: Disney(DIS), Nike(NKE), Coca-Cola(KO)

## 🏗️ プロジェクト構造

```
TradeSim/
├── app.py                          # メインアプリケーション
├── requirements.txt                # 依存関係
├── README.md                      # プロジェクト説明
├── config/                        # 設定管理
│   ├── __init__.py
│   └── settings.py               # 動的重み付け設定・定数
├── core/                         # アプリケーションコア
│   ├── __init__.py
│   ├── app_controller.py         # メイン業務ロジック（動的重み付け対応）
│   └── state_manager.py          # セッション状態管理（動的重み付け対応）
├── data/                         # データ取得・管理
│   ├── __init__.py
│   ├── stock_fetcher.py          # 株価データ取得・銘柄検索
│   ├── validators.py             # データ検証
│   └── cache_manager.py          # キャッシュ管理
├── analysis/                     # 分析エンジン
│   ├── __init__.py
│   ├── technical.py              # テクニカル分析
│   ├── signals.py                # シグナル生成（動的重み付け対応）
│   ├── pattern_detector.py       # 🆕 パターン検出機能
│   └── backtest.py               # バックテスト・パフォーマンス計算
├── ui/                           # ユーザーインターフェース
│   ├── __init__.py
│   ├── components.py             # UIコンポーネント
│   ├── styles.py                 # スタイル・CSS管理
│   ├── charts.py                 # インタラクティブチャート
│   ├── settings_ui.py            # 設定UI（動的重み付け対応）
│   ├── analysis_ui.py            # 分析結果表示UI（動的重み付け対応）
│   ├── portfolio_ui.py           # ポートフォリオ管理UI
│   └── guide_ui.py               # ユーザーガイドUI
└── portfolio/                    # ポートフォリオ管理
    ├── __init__.py
    └── manager.py                # ポートフォリオ管理機能
```

## 🔧 技術仕様

### 主要依存関係

|ライブラリ          |バージョン |用途                |
|---------------|------|------------------|
|**Streamlit**  |Latest|Webアプリケーションフレームワーク|
|**yfinance**   |Latest|株価データ取得           |
|**Plotly**     |Latest|インタラクティブチャート      |
|**TA-Lib (ta)**|Latest|テクニカル分析           |
|**Pandas**     |Latest|データ処理             |
|**NumPy**      |Latest|数値計算              |
|**SciPy**      |Latest|統計分析              |

### 🆕 動的重み付け技術仕様

#### パターン検出アルゴリズム
- **トレンド分析**: 移動平均の傾きと位置関係
- **ボラティリティ分析**: 価格変動の拡大・縮小パターン
- **モメンタム分析**: MACD・RSIの変化パターン
- **出来高分析**: 取引量の増減パターン
- **総合判定**: 各要素の統合スコアによるパターン分類

#### 重み付け最適化
```python
# 動的重み付けの例
DYNAMIC_WEIGHT_PROFILES = {
    'uptrend': {
        'ma_trend': 0.35,    # 移動平均35%
        'macd': 0.30,        # MACD30%
        'bollinger': 0.15,   # ボリンジャーバンド15%
        'rsi': 0.15,         # RSI15%
        'volume': 0.05       # 出来高5%
    },
    'range': {
        'rsi': 0.35,         # RSI35%
        'bollinger': 0.35,   # ボリンジャーバンド35%
        'ma_trend': 0.15,    # 移動平均15%
        'macd': 0.10,        # MACD10%
        'volume': 0.05       # 出来高5%
    }
}
```

### テクニカル分析指標

|指標           |説明          |動的重み付け活用    |
|-------------|------------|-------------|
|**移動平均線**    |短期・長期の価格平均  |トレンド系パターンで重要度UP|
|**RSI**      |相対力指数（0-100）|レンジ相場で重要度UP|
|**ボリンジャーバンド**|価格の標準的な変動範囲 |レンジ・調整局面で重要度UP|
|**MACD**     |移動平均収束拡散    |転換期で重要度UP|
|**出来高**      |取引量分析       |加速相場で重要度UP|

### 🎯 動的重み付け設定

#### 重み付けモード
- **固定モード**: 全パターンで同一重み付け
- **適応モード**: パターン検出により自動調整
- **手動モード**: ユーザーによる完全カスタマイズ

#### 信頼度しきい値
- **高信頼度**: 80%以上 - 強いパターン重み付け適用
- **中信頼度**: 60-80% - 標準的なパターン重み付け適用
- **低信頼度**: 60%未満 - 固定重み付けにフォールバック

#### リスクレベル対応
- **低リスク**: 最大ポジション60%、推奨損切り3%
- **中リスク**: 最大ポジション40%、推奨損切り5%
- **高リスク**: 最大ポジション20%、推奨損切り8%

### 機能別設定

#### プリセット設定
- **🔰 初心者向け**: 超安全設定（リスク1%、損切り3%）+ 固定重み付け
- **⚖️ バランス型**: 標準設定（リスク2%、損切り5%）+ 適応重み付け
- **🚀 積極型**: ハイリスク設定（リスク5%、損切り8%）+ 適応重み付け

#### バックテスト設定
- **初期資金**: 10万円 〜 1000万円
- **リスク許容率**: 0.5% 〜 5.0%
- **損切り率**: 1.0% 〜 20.0%
- **利益確定率**: 2.0% 〜 50.0%
- **取引手数料**: 0.0% 〜 1.0%

## 📈 教育コンテンツ

### 🆕 動的重み付け学習
- **パターン認識**: 6つの相場パターンの特徴と対応策
- **重み付け戦略**: 各パターンに最適な指標の使い分け
- **リスク管理**: パターン別のリスクレベルと対応方法
- **信頼度評価**: 検出結果の信頼性判断方法

### 従来の学習内容
- **株式投資の基本**: 会社の一部を買うという概念
- **リスクとリターン**: 利益と損失の関係
- **分散投資**: リスク分散の重要性
- **テクニカル分析**: チャート分析の基礎
- **投資ルール**: 感情的にならない投資の重要性

### 実践的アドバイス
- **パターン活用法**: 検出されたパターンに応じた戦略調整
- **重み付け理解**: なぜその重み付けが有効かの理論的背景
- **信頼度活用**: 低信頼度時の慎重な判断の重要性
- **リスク対応**: パターン別のリスク管理手法

## 📱 UI/UX特徴

### 🆕 動的重み付けUI
- **パターン検出結果表示**: 信頼度と戦略ヒントの直感的表示
- **重み付け可視化**: 各指標の重要度をプログレスバーで表示
- **リスクレベル表示**: パターンに応じた色分けされたリスク表示
- **戦略ヒント**: 検出されたパターンに応じた具体的な戦略提案

### 従来のUI特徴
- **レスポンシブデザイン**: 全デバイス対応
- **アクセシビリティ**: 高コントラスト、キーボード操作対応
- **段階的情報開示**: 初心者から上級者まで対応
- **視覚的フィードバック**: 色とアイコンによる直感的理解

## 🆕 v2.0 アップデート履歴

### 🎯 Major Features
- **パターン検出システム**: 6つの相場パターンの自動検出
- **動的重み付け分析**: 相場状況に応じた最適な重み付け調整
- **3モード対応**: 固定・適応・手動の重み付けモード
- **リスクレベル評価**: パターン別のリスク度合い自動判定

### 📊 Analysis Improvements
- **パターン別最適化**: 各相場パターンに特化した分析重み付け
- **信頼度フィルタリング**: 低信頼度時の自動フォールバック機能
- **高精度シグナル**: パターン検出による分析精度向上
- **戦略ヒント**: 検出パターンに応じた具体的な投資戦略提案

### 🔧 Technical Updates
- **パターン検出エンジン**: 新規`pattern_detector.py`モジュール
- **状態管理強化**: 動的重み付け対応のセッション管理
- **設定システム拡張**: 動的重み付け用設定項目追加
- **UI/UX強化**: パターン検出結果の直感的な表示

### 🐛 Bug Fixes
- **バックテストエラー処理**: フォールバック機能による安定性向上
- **メトリクス表示修正**: 数値の色分け表示の正確性改善
- **通貨表示対応**: 多通貨での適切な表示形式対応

## 📄 ライセンス

MIT License - 個人・教育・商用利用自由

## 🙏 謝辞

- **データ提供**: Yahoo Finance API
- **技術基盤**: Streamlit Community
- **分析ライブラリ**: TA-Lib, Plotly開発チーム
- **パターン検出**: 独自開発アルゴリズム
- **オープンソースコミュニティ**: 素晴らしいライブラリとツール

-----

## ⚠️ 重要な免責事項

このアプリケーションは**教育・学習目的**で開発されています。**動的重み付け分析やパターン検出機能を含む全ての機能は参考情報であり、投資助言や推奨を行うものではありません。**実際の投資判断は自己責任で行い、必要に応じて専門家にご相談ください。過去の成績は将来の結果を保証するものではありません。

**パターン検出の精度には限界があり、相場は予測不可能な要素を含んでいます。**検出結果の信頼度に関わらず、投資決定は慎重に行ってください。

**📚 学習目的での利用をお楽しみください！**

---

## 🔗 関連リンク

- **[📱 ライブデモ](https://tradesim-9djzkadr39vp8jt2dxcgud.streamlit.app/)**

**🎯 v2.0の動的重み付け機能で、より精度の高い株価分析学習をお楽しみください！**
